# IoT-Malware-Analysis-Graph-Embeddings-Similarity

This repository contains the implementation of a system for computing similarities between IoT malware samples using Control-Flow Graphs (CFGs) and graph embeddings. This code accompanies the research paper titled "Unveiling Hidden Structures: Multi-Platform IoT Malware Analysis Using Graph Embeddings".

## Overview

The system computes similarities between Control-Flow Graph (CFG) embeddings extracted from IoT malware binaries. The similarities are calculated using cosine similarity and matched using either a greedy algorithm or the Hungarian algorithm.

## Features
- **CFG Construction**: Builds Control-Flow Graphs (CFGs) from executable sections of ELF binaries.
- **Node Embeddings**: Computes node embeddings using the Node2Vec algorithm.
- **Edge Embeddings**: Computes edge embeddings using the Hadamard method.
- **Graph Embeddings**: Computes graph embeddings using the Graph2Vec algorithm.
- **Greedy Algorithm**: Finds the best matching similarities using a greedy approach.
- **Hungarian Algorithm**: Finds the optimal assignment of similarities using the Hungarian algorithm.
- **Similarity Computation**: Computes node, edge, and graph similarities and saves the results to CSV files.

## Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/remuspetrache/IoT-Malware-Analysis-Graph-Embeddings-Similarity.git
   cd IoT-Malware-Analysis-Graph-Embeddings-Similarity\IOTMalwareSimilarity 
   ```
2. Install the required dependencies:
	```bash
	pip install -r requirements.txt
	```

## Usage

To compute similarities between malware samples, follow these steps:

1. Prepare your malware binaries. Ensure they are in ELF format and located in a directory.

2. Run the script to process the binaries and compute the similarities:
	```bash
	python similarity_computation.py <directory_name>
	```
	Replace `<directory_name>` with the path to the directory containing the binaries you want to analyze.
	
3. You can select the algorithm used for similarity computation:
- By default, the script uses the Greedy algorithm for similarity computation. To use the Hungarian algorithm, modify the `run_general_tests` function in the script:
	```python
	run_general_tests(directory_name, do_hungarian=True)
	```
	
4. Loading Precomputed Embeddings:
- If you have precomputed embeddings and want to load them instead of computing from scratch, set the `load_emb` parameter to `True`:
	```python
	run_general_tests(directory_name, load_emb=True)
	```
